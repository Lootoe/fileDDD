## Bowyer-Watson四面体剖分

1. **初始化四面体**：
    - 在三维空间中，构建一个包含所有输入点的大四面体。这个大四面体通常由四个虚拟点组成，这些点远离实际数据点。

2. **逐点插入**：
    - 逐个插入每个输入点，并更新Delaunay三角剖分。
    - 对于每个插入的点，找到所有被该点的外接球体包含的四面体。这些四面体将被删除。

3. **删除四面体**：
    - 删除所有被新插入点的外接球体包含的四面体。
    - 这将形成一个空腔，称为“孔洞”。

4. **创建新的四面体**：
    - 在“孔洞”中，连接新插入点和孔洞的边界，生成新的四面体。
    - 新的四面体将填充孔洞，同时保持Delaunay性质。
      - 确保新生成的四面体满足德劳内条件（每个四面体的外接球内不包含其他点）。
      - 通过检查四面体的外接球（circumsphere）来验证德劳内条件。
    -  如果新生成的四面体不满足德劳内条件，进行局部调整。
      -  通过面翻转（Face Flipping）来优化四面体网格。面翻转是指在两个相邻四面体之间重新划分面，使其满足德劳内条件。
      - 检查相邻的两个四面体的公共面，确定其外接球内是否包含其他点。
      - 如果不满足条件，则进行面翻转，将原本的共面替换为新的对角线，形成新的四面体对。
    
5. **重复步骤2-4**：
    - 对每个剩余的输入点重复上述步骤，直到所有点都插入完毕。

6. **移除虚拟点**：
    - 最后，删除初始构建的大四面体的四个虚拟点以及与这些虚拟点相连的所有四面体。
    - 剩下的四面体就是包含所有输入点的Delaunay四面体剖分。